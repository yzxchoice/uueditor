var __reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(o,r){function a(t){try{h(n.next(t))}catch(e){r(e)}}function s(t){try{h(n["throw"](t))}catch(e){r(e)}}function h(t){t.done?o(t.value):new i(function(e){e(t.value)}).then(a,s)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(o)throw new TypeError("Generator is already executing.");for(;h;)try{if(o=1,r&&(a=r[2&i[0]?"return":i[0]?"throw":"next"])&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[0,a.value]),i[0]){case 0:case 1:a=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,r=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(a=h.trys,!(a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){h.label=i[1];break}if(6===i[0]&&h.label<a[1]){h.label=a[1],a=i;break}if(a&&h.label<a[2]){h.label=a[2],h.ops.push(i);break}a[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],r=0}finally{o=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var o,r,a,s,h={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},StyleBase=function(t){function e(e,i){var n=t.call(this)||this;return n.siderbar=Siderbar.getInstance(),n.image=n.siderbar.tool.target.owner.image,n.config=e,n.props=i,n.inputType=e.type,n.stateObj={title:e.title,content:n.image.getProps()[n.inputType]},n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){this.initEvent()},e.prototype.initEvent=function(){},e.prototype.updateValue=function(t){this.stateObj.content=t,this.props[this.inputType]=t;var e=this.image.getProps();e[this.inputType]=t,this.image.setProps(e),this.image.redraw()},e}(eui.Component);__reflect(StyleBase.prototype,"StyleBase");var StyleEditBae=function(t){function e(e,i){var n=t.call(this)||this;return n.siderbar=Siderbar.getInstance(),n.image=n.siderbar.tool.target.owner.image,n.config=e,n.props=i,n.stateObj={title:e.title,content:i[e.type]},n.skinName="resource/skins/StyleCircleSectorSkin.exml",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){this.initEvent(),this.initdata=this.image.getProps()[this.propsKey],this.data=this.exchangeInitdata(this.initdata)},e.prototype.initEvent=function(){this.lb_edit.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.onClick=function(){if(this.table&&this.table.isShow)this.table.undraw();else{var t=new Table(this.headData,this.data);t.listenChange(this.exchangeData.bind(this)),t.draw(this),t.x=0,t.y=60,this.table=t}},e.prototype.exchangeInitdata=function(t){for(var e=this.componenntTypeConfig,i=[],n=function(n,o){var r={},a=t[n];Object.keys(a).forEach(function(t){r[t]={value:a[t],componentType:e[t]}}),i.push(r)},o=0,r=t.length;r>o;o++)n(o,r);return i},e.prototype.exchangeData=function(){for(var t=[],e=function(e,n){var o={},r=i.data[e];Object.keys(r).forEach(function(t){o[t]=r[t].value}),t.push(o)},i=this,n=0,o=this.data.length;o>n;n++)e(n,o);this.initdata=this.props[this.propsKey]=t;var r=this.image.getProps();r[this.propsKey]=t,this.image.setProps(r),this.image.redraw()},e}(eui.Component);__reflect(StyleEditBae.prototype,"StyleEditBae");var StyleCircleSector=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.headData=["文本","图片"],n.propsKey="awards",n.componenntTypeConfig={text:"",url:"eui.Button"},n}return __extends(e,t),e}(StyleEditBae);__reflect(StyleCircleSector.prototype,"StyleCircleSector");var StyleColor=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.skinName="resource/skins/StyleTextColorSkin.exml",n}return __extends(e,t),e.prototype.initEvent=function(){this.lb_selectColor.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.onClick=function(){if(this.colorSelectBox&&this.colorSelectBox.isShow)this.colorSelectBox.undraw();else{var t=new ColorSelectBox;t.draw(this.parent),t.x=280,t.y=100,this.colorSelectBox=t,this.colorSelectBox.listenColorChange(this.changeColor.bind(this))}},e.prototype.changeColor=function(t){this.updateValue(t)},e}(StyleBase);__reflect(StyleColor.prototype,"StyleColor");var StyleImage=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.skinName="resource/skins/StyleImageSkin.exml",n}return __extends(e,t),e.prototype.initEvent=function(){this.btn_image.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.onClick=function(){var t=this,e=this.siderbar.parent;e.openImagePanel(function(e){t.updateValue(e)},!0)},e}(StyleBase);__reflect(StyleImage.prototype,"StyleImage");var StyleSlideshow=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.headData=["图片"],n.propsKey="awards",n.componenntTypeConfig={url:"eui.Button"},n}return __extends(e,t),e}(StyleEditBae);__reflect(StyleSlideshow.prototype,"StyleSlideshow");var StyleTextColor=function(t){function e(e,i){var n=t.call(this)||this;return n.config=e,n.props=i,n.inputType=e.type,n.stateObj={title:e.title,content:i[n.inputType]},n.skinName="resource/skins/StyleTextColorSkin.exml",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){this.initEvent()},e.prototype.initEvent=function(){this.lb_selectColor.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this)},e.prototype.onClick=function(){if(this.colorSelectBox&&this.colorSelectBox.isShow)this.colorSelectBox.undraw();else{var t=new ColorSelectBox;t.draw(this.parent),t.x=280,t.y=100,this.colorSelectBox=t,this.colorSelectBox.listenColorChange(this.changeColor.bind(this))}},e.prototype.changeColor=function(t){console.log("color = "+t),this.stateObj.content=t,this.props[this.inputType]=t},e}(eui.Component);__reflect(StyleTextColor.prototype,"StyleTextColor");var StyleTextInput=function(t){function e(e,i){var n=t.call(this)||this;return n.config=e,n.props=i,n.inputType=e.type,n.stateObj={title:e.title,content:i[n.inputType]},n.skinName="resource/skins/StyleInputSkin.exml",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){this.initEvent()},e.prototype.initEvent=function(){this.textInput_input.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onFocusOut,this),this.textInput_input.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusIn,this)},e.prototype.onFocusIn=function(t){console.log("onFocusIn...")},e.prototype.onFocusOut=function(t){console.log("onFocusOut...");var e=t.target.text;console.log("value = "+e),this.props[this.inputType]=e},e}(eui.Component);__reflect(StyleTextInput.prototype,"StyleTextInput");var StyleTextSelect=function(t){function e(e,i){var n=t.call(this)||this;return n.config=e,n.props=i,n.selectData=e.selectData,n.inputType=e.type,n.stateObj={title:e.title,content:i[n.inputType]},n.skinName="resource/skins/StyleSelect.exml",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n}return __extends(e,t),e.prototype.onAddToStage=function(){this.initSelect()},e.prototype.initSelect=function(){var t=new Select(this.selectData);this.gp_style_fontFamily_select.addChild(t),t.setDataContainer(this),t.setDefaultItem(this.props[this.inputType]),t.listenSelectChange(this.getFontFamily.bind(this))},e.prototype.getFontFamily=function(t){console.log("fontFamily = "+t),this.props[this.inputType]=t},e}(eui.Component);__reflect(StyleTextSelect.prototype,"StyleTextSelect");var Header=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.container.addChild(this)},e.prototype.onAddToStage=function(t){this.init()},e.prototype.init=function(){var t=new eui.HorizontalLayout;t.gap=30,t.horizontalAlign=egret.HorizontalAlign.RIGHT,t.verticalAlign=egret.VerticalAlign.MIDDLE,t.paddingRight=30,this.layout=t;var e=this.createBtn("老虎机");e.addEventListener(Mouse.START,this.onAddSlotMachine,this),this.addChild(e);var i=this.createBtn("轮播图");i.addEventListener(Mouse.START,this.onAddSlideShow,this),this.addChild(i);var n=new eui.Button;n.width=100,n.height=40,n.label="文本",n.addEventListener(Mouse.START,this.onAddText,this),this.addChild(n);var o=new eui.Button;o.width=100,o.height=40,o.label="加页",o.addEventListener(Mouse.START,this.onAddPage,this),this.addChild(o);var r=new eui.Button;r.width=100,r.height=40,r.label="组件",r.addEventListener(Mouse.START,this.openComponentPanel,this),this.addChild(r);var a=new eui.Button;a.width=100,a.height=40,a.label="边框",a.addEventListener(Mouse.START,this.openFramePanel,this),this.addChild(a);var s=new eui.Button;s.width=100,s.height=40,s.label="声音",s.addEventListener(Mouse.START,this.openSoundPanel,this),this.addChild(s);var h=new eui.Button;h.width=100,h.height=40,h.label="图片",h.addEventListener(Mouse.START,this.openImagePanel,this),this.addChild(h);var l=new eui.Button;l.width=100,l.height=40,l.label="背景",l.addEventListener(Mouse.START,this.openBgPanel,this),this.addChild(l);var d=new eui.Button;d.width=100,d.height=40,d.label="预览",d.addEventListener(Mouse.START,this.preview,this),this.addChild(d);var p=new eui.Button;p.width=100,p.height=40,p.label="发布",this.addChild(p);var c=new eui.Button;c.width=100,c.height=40,c.label="保存",c.addEventListener(Mouse.START,this.save,this),this.addChild(c)},e.prototype.createBtn=function(t){var e=new eui.Button;return e.width=100,e.height=40,e.label=t,e},e.prototype.save=function(t){return __awaiter(this,void 0,void 0,function(){var t,e,i,n;return __generator(this,function(o){switch(o.label){case 0:return t=this.parent,console.log(t.editGroup.pages[0]),console.log(JSON.stringify(t.editGroup.pages[0])),e={code:200,msg:"success",list:t.editGroup.pages},i="id="+Main.id+"&template="+encodeURIComponent(JSON.stringify(e))+"&resource="+encodeURIComponent(JSON.stringify(Utils.trans(t.editGroup.pages,Main.id))),[4,Fetch.start("http://10.63.5.131:8002/template/updateTemplate",i,"POST")];case 1:return n=o.sent(),[2]}})})},e.prototype.onAddSlideShow=function(){var t=this.container.editGroup;t.addResource1(UUType.SLIDESHOW)},e.prototype.onAddSlotMachine=function(){var t=this.container.editGroup;t.addResource1(UUType.SLOT_MACHINE)},e.prototype.onAddText=function(){var t=this.container.editGroup;t.addResource1(UUType.TEXT)},e.prototype.onAddPage=function(t){var e=this.parent;e.editGroup.addPage(),this.dispatchEvent(new PageEvent(PageEvent.PAGE_ADD,!0))},e.prototype.preview=function(t){var e=this.parent,i=new PreviewBox;i.draw(e)},e.prototype.openComponentPanel=function(t){var e=this.parent;e.openComponentPanel()},e.prototype.openFramePanel=function(t){var e=this.parent;e.openFramePanel()},e.prototype.openSoundPanel=function(t){var e=this.parent;e.openSoundePanel()},e.prototype.openImagePanel=function(t){var e=this.parent;e.openImagePanel()},e.prototype.openBgPanel=function(t){var e=this.parent;e.openBgPanel()},e}(eui.Group);__reflect(Header.prototype,"Header",["IUUContainer"]);var ImageBox=function(t){function e(){var e=t.call(this)||this;return e.imgList=[],e.isForComponent=!1,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.onAddToStage=function(t){this.init()},e.prototype.getResources=function(t,e,i){return __awaiter(this,void 0,void 0,function(){var n;return __generator(this,function(o){switch(o.label){case 0:return this.url=t,this.params=e,this.uutype=i,[4,Fetch.start(this.url,this.params)];case 1:return n=o.sent(),this.imgList=n,i===UUType.SOUND?this.renderSound():this.render(),[2]}})})},e.prototype.reset=function(){this._grpLayout.removeChildren()},e.prototype.renderSound=function(){this.reset();for(var t=0;t<this.imgList.length;t++){this.imgList[t].id=this.imgList[t]._id,this.imgList[t].url="/resource/"+this.imgList[t].img_path,this.imgList[t].name=this.imgList[t].url.substring(this.imgList[t].url.lastIndexOf("/")+1).replace(".","_");var e=new eui.Group;this._grpLayout.addChild(e);var i=new UULabel;i.text=this.imgList[t].name,i.data=this.imgList[t],i.addEventListener(Mouse.START,this.addSound,this),e.addChild(i)}},e.prototype.render=function(){this.reset();for(var t=0;t<this.imgList.length;t++){this.imgList[t].id=this.imgList[t]._id,this.imgList[t].url=this.imgList[t].img_path,this.imgList[t].name=this.imgList[t].url.substring(this.imgList[t].url.lastIndexOf("/")+1).replace(".","_");var e=new eui.Group;e.width=100,e.height=100,this._grpLayout.addChild(e);var i=new egret.Shape;i.graphics.lineStyle(1,10066329),i.graphics.beginFill(16777215,1),i.graphics.drawRect(0,0,e.width,e.height),i.graphics.endFill(),e.addChild(i);var n=new UUImage;n.source="resource/"+this.imgList[t].img_path,n.width=100,n.height=100,n.name=this.imgList[t].id,n.data=this.imgList[t],this.isForComponent?n.addEventListener(Mouse.START,this.addImageForComponent,this):n.addEventListener(Mouse.START,this.addImage,this),e.addChild(n)}},e.prototype.init=function(){if(!this._grpLayout){this.horizontalCenter=0,this.verticalCenter=0,this.width=1200,this.height=800,this._grpLayout=new eui.Group,this._grpLayout.horizontalCenter=0,this._grpLayout.verticalCenter=0,this.addChild(this._grpLayout),this._grpLayout.width=this.width,this._grpLayout.height=this.height-150;var t=new eui.TileLayout;t.paddingTop=30,t.paddingLeft=30,t.paddingRight=30,t.paddingBottom=30,this._grpLayout.layout=t}},e.prototype.addSound=function(t){var e=this,i=this.parent,n=i.editGroup.tool.target.owner.image.data,o=t.currentTarget.data;n.sound={id:o.id,name:o.name,url:o.url};var r=new PageEvent(PageEvent.SOUND_CHANGE,!0);r.data=n.sound,this.dispatchEvent(r),setTimeout(function(){e.close()},0)},e.prototype.addImage=function(t){var e=this,i=this.parent;i.editGroup.addResource(t.currentTarget.data,this.uutype),setTimeout(function(){e.close()},0)},e.prototype.addImageForComponent=function(t){var e=t.currentTarget.data;this.cb&&this.cb(e.url)},e.prototype.open=function(t,e,i){void 0===i&&(i=!1),this.container=t,this.cb=e,this.isForComponent=i,this.container.addChild(this)},e.prototype.close=function(){this.parent.removeChild(this)},e}(eui.Panel);__reflect(ImageBox.prototype,"ImageBox");var ImagesLoader=function(){function t(t){this.imageCount=0,this.images=[],this.completeCallback=t}return t.prototype.load=function(t){var e;for(this.imageCount=t.length,e=0;e<this.imageCount;e++)this.loadImage(t[e])},t.prototype.loadImage=function(t){var e=new egret.ImageLoader;this.images.push(e),e.addEventListener(egret.Event.COMPLETE,this.checkComplete,this),e.load(t)},t.prototype.checkComplete=function(){if(--this.imageCount<=0&&null!=this.completeCallback){var t=this.completeCallback;this.completeCallback=null,t()}},t}();__reflect(ImagesLoader.prototype,"ImagesLoader");var LayerItem=function(t){function e(e){var i=t.call(this)||this;return i.layerIndex=0,i.selected=!1,i.bg=new egret.Shape,i.layerIndex=e,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddedToStage,i),i}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.container.addChild(this)},e.prototype.undraw=function(t){this.container.removeChild(this)},e.prototype.onAddedToStage=function(){this.init(),this.initEvent()},e.prototype.init=function(){var t=new eui.HorizontalLayout;t.paddingLeft=30,t.verticalAlign="middle",t.gap=30,this.layout=t,this.bg.graphics.lineStyle(1,10066329),this.bg.graphics.beginFill(16777215,1),this.selected&&this.bg.graphics.beginFill(15921906,1),this.bg.graphics.drawRect(0,0,this.width,this.height),this.bg.graphics.endFill(),this.addChild(this.bg);var e=new eui.Group;e.width=50,e.height=50,e.verticalCenter=0,this.addChild(e);var i=new eui.Label;i.text="图层"+(this.layerIndex+1),i.textColor=0,i.size=28,i.lineSpacing=12,i.textAlign=egret.HorizontalAlign.JUSTIFY,this.addChild(i)},e.prototype.initEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.select,this)},e.prototype.select=function(t){if(this.container.editGroup.displayList[this.layerIndex].b){var e=new PageEvent(PageEvent.LAYER_SELECT,!0);e.data={t:this.container.editGroup.displayList[this.layerIndex]},this.dispatchEvent(e),this.container.redraw(this.layerIndex)}},e.prototype.redraw=function(){this.bg.graphics.clear(),this.bg.graphics.lineStyle(1,10066329),this.bg.graphics.beginFill(16777215,1),this.selected&&this.bg.graphics.beginFill(15921906,1),this.bg.graphics.drawRect(0,0,this.width,this.height),this.bg.graphics.endFill()},e}(eui.Group);__reflect(LayerItem.prototype,"LayerItem",["IUUContainer"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=400,this.textField.x=720,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center",this.textField.textColor=10066329;var t=new egret.Shape;t.height=30,t.width=480,t.x=720,t.y=350,t.graphics.beginFill(16777215,1),t.graphics.drawRoundRect(0,0,480,30,30),t.graphics.endFill(),this.addChild(t),this.progressBar=new egret.Shape,this.progressBar.x=720,this.progressBar.y=350,this.addChild(this.progressBar);var e=new egret.Shape;e.height=30,e.width=480,e.x=720,e.y=350,e.graphics.beginFill(13421772,1),e.graphics.drawRoundRect(0,0,480,30,30),e.graphics.endFill(),this.addChild(e),this.progressBar.mask=e},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e,this.progressBar.graphics.beginFill(4174069,1),this.progressBar.graphics.drawRoundRect(0,0,480*t/e,30,30),this.progressBar.graphics.endFill()},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return[4,this.loadResource()];case 1:return i.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=i.sent(),this.startAnimation(t),[4,platform.login()];case 3:return i.sent(),[4,platform.getUserInfo()];case 4:return e=i.sent(),console.log(e),[2]}})})},e.prototype.getQueryString=function(){for(var t=location.search.substr(1),e={},i=t.length?t.split("&"):[],n=null,o=i.length,r=0;o>r;r++){n=i[r].split("=");var a=decodeURIComponent(n[0]),s=decodeURIComponent(n[1]);a&&(e[a]=s)}return e},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,i,n,o;return __generator(this,function(r){switch(r.label){case 0:egret.log(this.getQueryString().id),t=this.getQueryString().id||2,e.id=t||"",i=t?"/"+t:"",r.label=1;case 1:return r.trys.push([1,7,,8]),n=new LoadingUI,this.stage.addChild(n),[4,RES.loadConfig("resource/default.res.json","resource/")];case 2:return r.sent(),[4,RES.loadConfig("resource/"+e.id+"/template.json","resource/")];case 3:return r.sent(),[4,this.loadTheme()];case 4:return r.sent(),[4,RES.loadGroup("preload",0,n)];case 5:return r.sent(),[4,RES.loadGroup("preloadpic",1,n)];case 6:return r.sent(),this.stage.removeChild(n),[3,8];case 7:return o=r.sent(),console.error(o),[3,8];case 8:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=new Game;this.addChild(t)},e.prototype.startAnimation=function(t){var e=this,i=new egret.HtmlTextParser,n=t.map(function(t){return i.parse(t)}),o=this.textfield,r=-1,a=function(){r++,r>=n.length&&(r=0);var t=n[r];o.textFlow=t;var i=egret.Tween.get(o);i.to({alpha:1},200),i.wait(2e3),i.to({alpha:0},200),i.call(a,e)};a()},e}(eui.UILayer);__reflect(Main.prototype,"Main");var PageEvent=function(t){function e(e,i,n){return void 0===i&&(i=!1),void 0===n&&(n=!1),t.call(this,e,i,n)||this}return __extends(e,t),e.PAGE_CHANGE="pageChange",e.PAGE_ADD="pageAdd",e.LAYER_ADD="layerAdd",e.LAYER_CHANGE="layerChange",e.LAYER_SELECT="layerSelect",e.SOUND_CHANGE="soundChange",e}(egret.Event);__reflect(PageEvent.prototype,"PageEvent");var PageItem=function(t){function e(e){var i=t.call(this)||this;return i.pageIndex=0,i.selected=!1,i.pageIndex=e,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddedToStage,i),i}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.container.addChild(this)},e.prototype.undraw=function(t){this.container.removeChild(this)},e.prototype.onAddedToStage=function(){this.init(),this.initEvent()},e.prototype.init=function(){var t=new eui.HorizontalLayout;t.paddingLeft=30,t.verticalAlign="middle",t.gap=30,this.layout=t;var e=new egret.Shape;e.graphics.lineStyle(1,10066329),e.graphics.beginFill(16777215,1),this.selected&&e.graphics.beginFill(15921906,1),e.graphics.drawRect(0,0,this.width,this.height),e.graphics.endFill(),this.addChild(e);var i=new eui.Group;i.width=50,i.height=50,i.verticalCenter=0,this.addChild(i);var n=new egret.Shape;n.graphics.beginFill(1414143,1),n.graphics.drawCircle(25,25,25),n.graphics.endFill(),i.addChild(n);var o=new eui.Label;o.text=String(this.pageIndex+1),o.textColor=16777215,o.size=28,o.lineSpacing=12,o.textAlign=egret.HorizontalAlign.JUSTIFY,o.horizontalCenter=0,o.verticalCenter=0,i.addChild(o);var r=new eui.Label;r.text="第"+(this.pageIndex+1)+"页",r.textColor=0,r.size=28,r.lineSpacing=12,r.textAlign=egret.HorizontalAlign.JUSTIFY,this.addChild(r)},e.prototype.initEvent=function(){this.addEventListener(egret.TouchEvent.TOUCH_TAP,this.changePage,this)},e.prototype.changePage=function(t){var e=new PageEvent(PageEvent.PAGE_CHANGE,!0);e.data={pageIndex:this.pageIndex},this.dispatchEvent(e),this.container.redraw(this.pageIndex)},e}(eui.Group);__reflect(PageItem.prototype,"PageItem",["IUUContainer"]);var DebugPlatform=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var PreviewBox=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.container.addChild(this),this.width=1920,this.height=1080;var e=new egret.Shape;e.graphics.beginFill(13421772,1),e.graphics.drawRect(0,0,1920,1080),e.graphics.endFill(),this.addChild(e);var i=new Preview;i.width=1200,i.height=900,i.horizontalCenter=0,this.addChild(i);var n=new eui.Button;n.y=0,n.right=0,n.width=100,n.height=40,n.label="关闭",n.addEventListener(Mouse.START,this.close,this),this.addChild(n)},e.prototype.close=function(t){this.parent.removeChild(this)},e}(eui.Group);__reflect(PreviewBox.prototype,"PreviewBox",["IUUContainer"]);var Select=function(t){function e(e,i){void 0===i&&(i=190);var n=t.call(this)||this;return n.stateObj={selectionVisible:!1,selectedItem:"default"},n.isFirstSelect=!0,n.itemHeight=30,n.selectData=e,n.itemWidth=i,n.skinName="resource/skins/SelectSkin.exml",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddedToStage,n),n}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){},e.prototype.onAddedToStage=function(){this.init()},e.prototype.init=function(){this.listenEvent()},e.prototype.setDefaultItem=function(t){this.stateObj.selectedItem=t},e.prototype.setDataContainer=function(t){this.dataContainer=t},e.prototype.hide=function(){this.stateObj.selectionVisible=!1},e.prototype.output=function(){this.cb&&this.cb(this.stateObj.selectedItem)},e.prototype.listenSelectChange=function(t){this.cb=t},e.prototype.listenEvent=function(){this.gp_selection_rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchSelection2,this)},e.prototype.setData=function(t){this.selectData=t},e.prototype.createItem=function(t){var e=new eui.Group;e.width=this.itemWidth,e.height=this.itemHeight;var i=new egret.Shape;i.graphics.beginFill(1414143),i.graphics.drawRect(0,0,this.itemWidth,this.itemHeight),i.graphics.endFill(),i.visible=!1,i.name="shape",e.addChild(i);var n=new eui.Label;return n.text=t.content,n.textColor=0,n.size=24,n.width=this.itemWidth,n.height=this.itemHeight,e.addChild(n),e},e.prototype.touchSelection2=function(t){if(t.stopPropagation(),this.stateObj.selectionVisible=!this.stateObj.selectionVisible,this.stateObj.selectionVisible){this.gp_selection.removeChildren();for(var e=0,i=this.selectData.length;i>e;e++){var n=this.createItem(this.selectData[e]);this.gp_selection.addChild(n)}if(!this.isFirstSelect)return;this.isFirstSelect=!1,this.gp_selection.addEventListener(mouse.MouseEvent.MOUSE_OVER,this.onMouseover_Selection,this),this.gp_selection.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_Selection,this)}},e.prototype.onMouseover_Selection=function(t){var e=t.target;if(!(e instanceof eui.Group)){this.removeOverState();var i=e.parent.getChildByName("shape");i.visible=!0}},e.prototype.removeOverState=function(){for(var t=0,e=this.gp_selection.numChildren;e>t;t++){var i=this.gp_selection.getChildAt(t),n=i.getChildByName("shape");n.visible=!1}},e.prototype.onClick_Selection=function(t){var e=t.target;if(!(e instanceof eui.Group)){var i=e.text;this.stateObj.selectedItem=i,this.stateObj.selectionVisible=!1,this.output()}},e}(eui.Component);__reflect(Select.prototype,"Select",["IUUContainer"]);var Siderbar=function(t){function e(){var e=t.call(this)||this;return e.skinName="resource/skins/SiderbarSkin.exml",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStageInit,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.editGroup=this.container.editGroup,this.tool=this.editGroup.tool,this.container.addChild(this)},e.getInstance=function(){return null==e._instance&&(e._instance=new e),e._instance},e.prototype.selectTarget=function(){this.component_style.setTarget(),this.component_event.getTargetItemId();var t=this.editGroup;this.component_event.triggerGroup=t.pages[t.pageIndex].properties.triggerGroup},e.prototype.moveTarget=function(){this.component_style.updateTarget()},e.prototype.upTarget=function(){this.component_style.updateTarget()},e.prototype.renderOneDisplay=function(){this.editGroup.renderOneDisplay()},e.prototype.updateDisplay=function(t){this.editGroup.updateDisplay(t)},e.prototype.onAddToStageInit=function(t){this.init()},e.prototype.init=function(){this.listenEvent(),this.component_style.draw(this),this.component_animation.draw(this),this.component_event.draw(this),this.component_layer.draw(this),this.currentState="style"},e.prototype.listenEvent=function(){this.gp_tabs.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchTabsClick,this)},e.prototype.touchTabsClick=function(t){this.scl_eventContainer.viewport.scrollV=0,this.currentState=t.target.parent.name},e._instance=null,e}(eui.Component);__reflect(Siderbar.prototype,"Siderbar",["IUUContainer"]);var AnimateSet=function(){function t(){throw new Error("can not create a instance")}return t.move=function(){var t=this;egret.Tween.get(this.target,{loop:!0}).to({x:this.target.width},2e3).call(function(){t.target.rotation=0},this,["param1",{key:"key",value:3}]).wait(1e3)},t}();__reflect(AnimateSet.prototype,"AnimateSet");var prefixApi="http://10.63.5.131:8002/",getImages=prefixApi+"image/getImages",AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var CheckItem=function(t){function e(e){var i=t.call(this)||this;return i.labelText=e,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(e,t),Object.defineProperty(e.prototype,"isOver",{get:function(){return this._isOver},set:function(t){this._isOver=t,this.shape.visible=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){return this._isSelected},set:function(t){this._isSelected=t,this.checkBox.selected=t},enumerable:!0,configurable:!0}),e.prototype.onAddToStage=function(){this.width=this.parent.width,this.height=30,this.shape=new egret.Shape,this.shape.graphics.beginFill(1673959),this.shape.graphics.drawRect(0,0,this.width,this.height),this.shape.graphics.endFill(),this.isOver=!1,this.addChild(this.shape),this.checkBox=new eui.CheckBox,this.checkBox.label=this.labelText,this.checkBox.width=this.width,this.checkBox.height=this.height,this.addChild(this.checkBox)},e}(eui.Group);__reflect(CheckItem.prototype,"CheckItem");var ColorSelectBox=function(t){function e(){var e=t.call(this)||this;return e.isShow=!1,e.colorPool=["#000000","#993300","#333300","#003300","#003366","#000080","#333399","#333333","#800000","#FF6600","#808000","#008000","#008080","#0000FF","#666699","#808080","#FF0000","#FF9900","#99CC00","#339966","#33CCCC","#3366FF","#800080","#999999","#FF00FF","#FFCC00","#FFFF00","#00FF00","#00FFFF","#00CCFF","#993366","#CCCCCC","#FF99CC","#FFCC99","#FFFF99","#CCFFCC","#CCFFFF","#99CCFF","#CC99FF","#FFFFFF"],e.skinName="resource/skins/ColorSelectBoxSkin.exml",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.onAddedToStage=function(){this.init()},e.prototype.init=function(){this.gp_box.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this);for(var t=0,e=this.colorPool.length;e>t;t++){var i=this.exchangeColor(this.colorPool[t]),n=this.createShape(i),o=t%8;n.x=5+26*o,n.y=5+26*Math.floor(t/8),n.touchEnabled=!0,this.gp_box.addChild(n)}},e.prototype.onClick=function(t){var e=t.target.name;if(!(t.target instanceof eui.Group)){var i=Number(e).toString(16),n="0x",o=i.length;1==o?n+="00000":2==o?n+="0000":4==o&&(n+="00");var r=n+i;this.undraw(),this.cb&&this.cb(r)}},e.prototype.createShape=function(t){var e=new egret.Shape;return e.graphics.beginFill(t),e.graphics.drawRect(0,0,20,20),e.graphics.endFill(),e.name=t,e},e.prototype.exchangeColor=function(t){return parseInt(t.replace("#",""),16)},e.prototype.listenColorChange=function(t){this.cb=t},e.prototype.draw=function(t){this.container=t,this.container.addChild(this),this.isShow=!0},e.prototype.undraw=function(){this.container.removeChild(this),this.isShow=!1},e}(eui.Component);__reflect(ColorSelectBox.prototype,"ColorSelectBox");var StyleInput=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.skinName="resource/skins/StyleInputSkin.exml",n}return __extends(e,t),e.prototype.initEvent=function(){this.textInput_input.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onFocusOut,this)
},e.prototype.onFocusOut=function(t){var e=t.target.text;this.updateValue(e)},e}(StyleBase);__reflect(StyleInput.prototype,"StyleInput");var StyleSelect=function(t){function e(e,i){var n=t.call(this,e,i)||this;return n.selectData=e.selectData,n.skinName="resource/skins/StyleSelect.exml",n}return __extends(e,t),e.prototype.initEvent=function(){var t=new Select(this.selectData);this.gp_style_fontFamily_select.addChild(t),t.setDataContainer(this),t.setDefaultItem(this.props[this.inputType]),t.listenSelectChange(this.getFontFamily.bind(this))},e.prototype.getFontFamily=function(t){this.updateValue(t)},e}(StyleBase);__reflect(StyleSelect.prototype,"StyleSelect");var EditGroup=function(t){function e(){var e=t.call(this)||this;return e.displayList=[],e.pages=[],e.pageIndex=0,e.borderColor=13421772,e.displayGroup=new eui.Group,e.siderbar=Siderbar.getInstance(),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this)},e.prototype.onAddToStage=function(t){this.tool=new TransformTool(this),this.maskTool=new TransformTool(this),this.bindHandlers(),this.getPages(),this.initEui(),this.init()},e.prototype.bindHandlers=function(){this.render=this.render.bind(this),this.renderOneDisplay=this.renderOneDisplay.bind(this)},e.prototype.initEui=function(){this.displayGroup.width=this.width,this.displayGroup.height=this.height,this.displayGroup.scrollEnabled=!0,this.addChild(this.displayGroup)},e.prototype.getPages=function(){this.pages=RES.getRes("data_json").list},e.prototype.init=function(){this.renderResources(this.pageIndex),this.setupTool(),this.addEventListener(Mouse.START,this.down,this),this.stage.addEventListener(PageEvent.PAGE_CHANGE,this.go,this),this.stage.addEventListener(PageEvent.LAYER_SELECT,this.select,this),this.render()},e.prototype.setupTool=function(){ControlSet.controlClass=EgretControl,this.tool.setControls(ControlSet.getUniformScaler())},e.prototype.getCustomControls=function(){var t=new EgretControl(ControlType.TRANSLATE);t.hitTestTarget=!0;var e=new EgretControl(ControlType.TARGET);return[new EgretControl(ControlType.ROTATE,0,0,0,0,40),new EgretControl(ControlType.ROTATE,0,1,0,0,40),new EgretControl(ControlType.ROTATE,1,0,0,0,40),new EgretControl(ControlType.ROTATE,1,1,0,0,40),e,t,new EgretControl(ControlType.BORDER),new EgretControl(ControlType.REGISTRATION,.5,.5,0,0,20),new EgretControl(ControlType.SKEW_Y,0,.5,0,0,10),new EgretControl(ControlType.SCALE_X,1,.5,0,0,10),new EgretControl(ControlType.SKEW_X,.5,0,0,0,10),new EgretControl(ControlType.SCALE_Y,.5,1,0,0,10),new EgretControl(ControlType.SCALE,0,0,0,0,10),new EgretControl(ControlType.SCALE,0,1,0,0,10),new EgretControl(ControlType.SCALE,1,0,0,0,10),new EgretControl(ControlType.SCALE,1,1,0,0,10),new EgretControl(ControlType.ROTATE_SCALE,1,0,15,-15,10),new EgretControl(ControlType.SCALE_UNIFORM,1,1,15,15,10),new EgretControl(ControlType.ROTATE,.5,0,0,-20)]},e.prototype.down=function(t){Mouse.get(t,this);var e=this.tool.start(Mouse.x,Mouse.y);return this.containsPoint(Mouse.x,Mouse.y)?(!e&&this.selectImage(Mouse.x,Mouse.y)&&(e=this.tool.start(Mouse.x,Mouse.y,this.findControlByType(ControlType.TRANSLATE))),e&&(this.addEventListener(Mouse.MOVE,this.move,this),this.addEventListener(Mouse.END,this.up,this),this.siderbar.selectTarget()),requestAnimationFrame(this.render),void t.preventDefault()):!1},e.prototype.move=function(t){Mouse.get(t,this),this.applyDynamicControls(t),this.tool.move(Mouse.x,Mouse.y),this.siderbar.moveTarget(),requestAnimationFrame(this.render),t.preventDefault()},e.prototype.up=function(t){this.tool.end();var e=this.pages[this.pageIndex].elements;if(this.tool.target)for(var i=0;i<e.length;i++)e[i].id===this.tool.target.owner.image.data.id&&(e[i].matrix=this.tool.target.matrix);this.removeEventListener(Mouse.MOVE,this.move,this),this.removeEventListener(Mouse.END,this.up,this),this.siderbar.upTarget(),requestAnimationFrame(this.render),t.preventDefault()},e.prototype.setProperty=function(t,e){var i=this.pages[this.pageIndex].elements,n=this.tool.target.matrix;n.translate(t,e);for(var o=0;o<i.length;o++)i[o].id===this.tool.target.owner.image.name&&(i[o].matrix=n)},e.prototype.applyDynamicControls=function(t){var e=this.getDynamicControl();e&&(t.ctrlKey?t.shiftKey?e.type=ControlType.ROTATE_SCALE:e.type=ControlType.ROTATE:t.shiftKey?e.type=ControlType.SCALE:e.type=ControlType.TRANSLATE)},e.prototype.getDynamicControl=function(){var t=0,e=this.tool.controls.length;for(t=0;e>t;t++)if(this.tool.controls[t].dynamicUV)return this.tool.controls[t];return null},e.prototype.findControlByType=function(t){var e=0,i=this.tool.controls.length;for(e=0;i>e;e++)if(this.tool.controls[e].type==t)return this.tool.controls[e];return null},e.prototype.containsPoint=function(t,e){var i=this.parent.localToGlobal(this.matrix.tx,this.matrix.ty),n=this.localToGlobal(Mouse.x,Mouse.y),o=new Matrix(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,i.x,i.y);return o.containsPoint(n.x,n.y,this.width,this.height)},e.prototype.select=function(t){this.tool.setTarget(t.data.t.transform),requestAnimationFrame(this.render),t.preventDefault()},e.prototype.selectImage=function(t,e){for(var i=null,n=null,o=this.displayList.length;o--;){if(i=this.displayList[o],!i.b)return console.log("点击了背景..."),this.tool.setTarget(null),this.clear(),!1;if(n=i.transform,n.matrix.containsPoint(t,e,n.width,n.height)){if(this.tool.target!==n){this.tool.setTarget(n);var r=new PageEvent(PageEvent.LAYER_CHANGE,!0);return r.data={layerIndex:o},this.dispatchEvent(r),!0}return!1}}var a=new egret.Point(t,e),s=new egret.Rectangle(0,0,this.width,this.height);return s.containsPoint(a)?(this.tool.setTarget(null),!1):void 0},e.prototype.renderResources=function(t){return __awaiter(this,void 0,void 0,function(){var e,i,n,o,r,a,s;return __generator(this,function(h){switch(h.label){case 0:e=this.pages[t].elements,i=e.length,n=0,h.label=1;case 1:return i>n?(o=RES.getRes(e[n].name),r=LayerSet.getLayer(Utils.getComs(),e[n].type)[0],a=LayerSet.createInstance(r,e[n].props),a.name=e[n].id,a.data=e[n],o||e[n].type!==UUType.IMAGE&&e[n].type!==UUType.BACKGROUND?[3,3]:(s=a,[4,Utils.getTexture("resource/"+e[n].src)])):[3,6];case 2:return s.texture=h.sent(),[3,4];case 3:a.texture=o,h.label=4;case 4:this.displayList.push(new Picture(a,e[n].matrix,e[n].type==UUType.BACKGROUND?!1:!0)),h.label=5;case 5:return n++,[3,1];case 6:return requestAnimationFrame(this.render),[2]}})})},e.prototype.render=function(){this.clear(),this.drawDisplayList(),this.tool.draw()},e.prototype.renderOneDisplay=function(){var t=this.tool.target;if(t){var e=t.owner;this.clear(),e.draw(this.displayGroup),this.tool.draw()}},e.prototype.clear=function(){this.tool.undraw()},e.prototype.reset=function(){this.clear(),this.tool.setTarget(null);var t=0,e=this.displayList.length;for(t=0;e>t;t++)this.displayList[t].undraw(this.displayGroup);this.displayList=[]},e.prototype.drawDisplayList=function(){var t=0,e=this.displayList.length;for(t=0;e>t;t++)this.displayList[t].draw(this.displayGroup)},e.prototype.pre=function(t){if(this.pageIndex>0){this.pageIndex--;var e=new PageEvent(PageEvent.PAGE_CHANGE,!0);e.data={pageIndex:this.pageIndex},this.dispatchEvent(e)}},e.prototype.next=function(t){if(this.pageIndex<this.pages.length-1){this.pageIndex++;var e=new PageEvent(PageEvent.PAGE_CHANGE,!0);e.data={pageIndex:this.pageIndex},this.dispatchEvent(e)}},e.prototype.go=function(t){this.reset(),this.pageIndex=t.data.pageIndex,this.renderResources(this.pageIndex)},e.prototype.updateDisplay=function(t){this.updateDisplayProps(t),t.draw(this)},e.prototype.updateDisplayProps=function(t){var e=t.image,i=e.data.props;for(var n in i)e[n]=i[n]},e.prototype.triggerMaskById=function(t){for(var e,i=t,n=this.displayList,o=0,r=n.length;r>o;o++){var a=n[o];if(a.image.data.id==i){e=a.transform;break}}return e?(this.maskTool.setPreTarget(e),void this.maskTool.addMask()):void this.maskTool.removeMask()},e.prototype.addResource=function(t,e){switch(e){case UUType.IMAGE:case UUType.BACKGROUND:case UUType.FRAME:case UUType.CIRCLE_SECTOR:this.addResource1(e,t);break;case UUType.SOUND:this.addSound(t);default:this.addResource1(e,t)}},e.prototype.addSound=function(t){var e=new Matrix(1,0,0,1,300,500),i=t.name,n=this.pages[this.pageIndex].elements,o=this.pages[this.pageIndex].properties.triggerGroup;t.id=t.id+"-"+this.displayList.length,n.push({id:t.id,name:i,pageId:201807311008,type:UUType.SOUND,matrix:{a:e.a,b:e.b,c:e.c,d:e.d,x:e.x,y:e.y},props:{width:100,height:50},sound:{id:t.id,name:i,src:t.url},sceneId:1001}),o.push({delay:0,eventType:1,sourceId:t.id,sourceType:"e",targetId:t.id,targetState:4,targetType:"e"});var r=new SoundButton;r.label=t.name,r.name=t.id,r.width=100,r.height=50,r.data=t,this.displayList.push(new Picture(r,e)),requestAnimationFrame(this.render)},e.prototype.addPage=function(){var t=this.pages;t.push({id:Date.now,elements:[],properties:{triggerGroup:[]}})},e.prototype.addResource1=function(t,e){return __awaiter(this,void 0,void 0,function(){var i,n,o,r,a,s,h;return __generator(this,function(l){switch(l.label){case 0:return i=LayerSet.getLayer(Utils.getComs(),t)[0],n=LayerSet.createInstance(i,{}),o=(new Date).valueOf().toString(),r={id:o,name:e?e.url.substring(e.url.lastIndexOf("/")+1).replace(".","_"):o,pageId:201807311008,type:t,matrix:new Matrix(1,0,0,1,300,300),props:n.getProps?n.getProps():{}},(r.type===UUType.IMAGE||r.type===UUType.BACKGROUND)&&(r.src=e?e.url:""),a=this.pages[this.pageIndex].elements,s=RES.getRes(r.name),n.name=r.id,n.data=r,s||r.type!==UUType.IMAGE&&r.type!==UUType.BACKGROUND?[3,2]:(h=n,[4,Utils.getTexture("resource/"+r.src)]);case 1:return h.texture=l.sent(),[3,3];case 2:n.texture=s,l.label=3;case 3:return r.type==UUType.BACKGROUND?(a.length>0&&a[0].type==UUType.BACKGROUND&&(this.displayList[0].undraw(this.displayGroup),this.displayList.splice(0,1),a.splice(0,1)),r.matrix=new Matrix(this.displayGroup.width/s.bitmapData.width,0,0,this.displayGroup.width/s.bitmapData.width,0,0),a.unshift(r),this.displayList.unshift(new Picture(n,r.matrix,!1))):(a.push(r),this.displayList.push(new Picture(n,r.matrix,!0))),this.dispatchEvent(new PageEvent(PageEvent.LAYER_ADD,!0)),requestAnimationFrame(this.render),[2]}})})},e}(eui.Group);__reflect(EditGroup.prototype,"EditGroup");var StyleSound=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e.prototype.setData=function(t){this.d=t,this.reset(),this.render()},e.prototype.onAddToStage=function(){this.stage.addEventListener(PageEvent.SOUND_CHANGE,this.cb,this)},e.prototype.draw=function(t){this.horizontalCenter=0,this.container=t,this.container.addChild(this)},e.prototype.reset=function(){this.removeChildren()},e.prototype.render=function(){var t=new eui.Button;t.width=300,t.height=50,t.label=this.d?this.d.name:"添加音效",t.addEventListener(Mouse.START,this.select,this),this.addChild(t)},e.prototype.select=function(){var t=this.container.parent.parent,e=t.editGroup.parent.parent;e.openSoundePanel()},e.prototype.cb=function(t){this.setData(t.data)},e}(eui.Group);__reflect(StyleSound.prototype,"StyleSound");var EventSetDome=function(t){function e(){var e=t.call(this)||this;return e._isShow=!0,e.skinName="resource/skins/EventSet.exml",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStageInit,e),e}return __extends(e,t),e.prototype.dispose=function(){for(var t=this.data,e=null,i=0,n=this.triggerGroup.length;n>i;i++){var o=this.triggerGroup[i];if(t.sourceId==o.sourceId&&t.targetId==o.targetId){e=i;break}}null!==e&&this.triggerGroup.splice(e,1)},e.prototype.draw=function(t){this.container=t,this.container.addChild(this)},Object.defineProperty(e.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t,this.stateObj=JSON.parse(JSON.stringify(t))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShow",{get:function(){return this._isShow},set:function(t){console.log("isShow = "+t),this._isShow=t,this.currentState=t?"show":"hidden",this.data.targetState=t?1:2},enumerable:!0,configurable:!0}),e.prototype.onAddToStageInit=function(t){var e=this;this.btn_show.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isShow=!0},this),this.btn_hidden.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.isShow=!1},this),this.input_time.addEventListener(egret.FocusEvent.FOCUS_OUT,function(t){e.data.delay=Number(t.target.text)},this),this.label_close.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.removeData()},this)},e.prototype.getDataContainer=function(t){this.dataContainer=t,this.triggerGroup=this.dataContainer.triggerGroup},e.prototype.initData=function(t){this.data=t,this.name=t.targetId,this.isShow=1==t.targetState?!0:!1},e.prototype.pushData=function(){this.triggerGroup.push(this.data)},e.prototype.removeData=function(){var t=this.data.targetId;this.container.removeChild(this),this.dispose(),this.dataContainer.relevanceItemIdList.splice(this.dataContainer.relevanceItemIdList.indexOf(t),1)},e}(eui.Component);__reflect(EventSetDome.prototype,"EventSetDome",["IUUContainer"]);var Fetch=function(){function t(){}return t.start=function(t,e,i,n){var o=this;return void 0===t&&(t=""),void 0===e&&(e={}),void 0===i&&(i="GET"),void 0===n&&(n="JSON"),new Promise(function(n,r){function a(t){var e=t.currentTarget;n(JSON.parse(e.response))}function s(t){egret.log("post error : "+t),r(t)}function h(t){egret.log("post progress : "+Math.floor(100*t.bytesLoaded/t.bytesTotal)+"%")}var l="";"GET"==i&&(Object.keys(e).forEach(function(t){l+=t+"="+e[t]+"&"}),""!==l&&(l=l.substr(0,l.lastIndexOf("&")),t=t+"?"+l));var d=new egret.HttpRequest;d.responseType=egret.HttpResponseType.TEXT,d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.open(t,i),d.send(e),d.addEventListener(egret.Event.COMPLETE,a,o),d.addEventListener(egret.IOErrorEvent.IO_ERROR,s,o),d.addEventListener(egret.ProgressEvent.PROGRESS,h,o)})},t}();__reflect(Fetch.prototype,"Fetch");var Game=function(t){function e(){var e=t.call(this)||this;return e.borderColor=13421772,e.editGroup=new EditGroup,e.header=new Header,e.imgBox=ImageBox.getInstance(),e.Siderbar=Siderbar.getInstance(),e.skinName="resource/skins/GameSkin.exml",e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStageInit,e),e}return __extends(e,t),e.prototype.onAddToStageInit=function(t){this.initEui(),mouse.enable(this.stage),mouse.setMouseMoveEnabled(!0)},e.prototype.initEui=function(){return __awaiter(this,void 0,void 0,function(){var t,e,i,n,o,r;return __generator(this,function(a){return t=new eui.Group,t.x=0,t.y=110,this.addChild(t),e=new egret.Shape,e.graphics.beginFill(16777215,1),e.graphics.drawRect(0,0,1200,900),e.graphics.endFill(),t.addChild(e),this.editGroup.width=1200,this.editGroup.height=900,this.editGroup.x=0,this.editGroup.y=0,this.editGroup.scrollEnabled=!0,t.addChild(this.editGroup),this.header.x=0,this.header.y=0,this.header.width=1920,this.header.height=100,this.drawBg(this.header),this.header.draw(this),this.Siderbar.x=1420,this.Siderbar.y=this.header.height+10,this.Siderbar.draw(this),i=new eui.HorizontalLayout,i.gap=30,i.horizontalAlign=egret.HorizontalAlign.CENTER,i.verticalAlign=egret.VerticalAlign.MIDDLE,i.paddingRight=30,n=new eui.Group,n.width=1200,n.height=100,n.x=0,n.layout=i,n.bottom=0,this.addChild(n),o=new eui.Button,o.width=100,o.height=40,o.label="上一页",o.x=0,o.addEventListener(Mouse.START,this.editGroup.pre,this.editGroup),n.addChild(o),mouse.setButtonMode(o,!0),r=new eui.Button,r.y=50,r.width=100,r.height=40,r.label="下一页",r.addEventListener(Mouse.START,this.editGroup.next,this.editGroup),n.addChild(r),[2]})})},e.prototype.openComponentPanel=function(){this.imgBox.open(this),this.imgBox.getResources(getImages,{tag:101},UUType.CIRCLE_SECTOR)},e.prototype.openFramePanel=function(){this.imgBox.open(this),this.imgBox.getResources(getImages,{tag:102},UUType.FRAME)},e.prototype.openSoundePanel=function(t){this.imgBox.open(this,t),this.imgBox.getResources(getImages,{tag:103},UUType.SOUND)},e.prototype.openImagePanel=function(t,e){void 0===e&&(e=!1),this.imgBox.open(this,t,e),this.imgBox.getResources(getImages,{tag:1},UUType.IMAGE)},e.prototype.openBgPanel=function(){this.imgBox.open(this),this.imgBox.getResources(getImages,{tag:2},UUType.BACKGROUND)},e.prototype.closeImagePanel=function(){this.imgBox.close()},e.prototype.drawBg=function(t,e){void 0===e&&(e=1);var i=new egret.Shape;i.graphics.lineStyle(2,this.borderColor),i.graphics.beginFill(16777215,e),i.graphics.drawRect(0,0,t.width,t.height),i.graphics.endFill(),t.addChild(i)},e}(eui.Component);__reflect(Game.prototype,"Game");var StyleType=function(t){function e(e,i){var n=t.call(this)||this;return n.siderbar=Siderbar.getInstance(),console.log("styleType..."),console.log(e),n.styleType=e,console.log("props..."),console.log(i),n.props=i||{},n._props=JSON.parse(JSON.stringify(n.props)),n.skinName="resource/skins/StyleTypeSkin.exml",n.addEventListener(egret.Event.ADDED_TO_STAGE,n.onAddToStage,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.removeFromStage,n),n}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.container.addChild(this)},e.prototype.onAddToStage=function(){this.isTargetSelected()&&(this.initPanel(),this.bindData())},e.prototype.removeFromStage=function(){this.clearPanel()},e.prototype.clearPanel=function(){this.gp_styleContainer.removeChildren()},e.prototype.initPanel=function(){var t=UUPanelConfig[this.styleType];if(t)for(var e=0,i=t.length;i>e;e++){var n=t[e],o=this.createComponent(n,this.props);o.y=70*e,this.gp_styleContainer.addChild(o),this.gp_styleContainer.setChildIndex(o,1)}},e.prototype.createComponent=function(t,e){var i=t.componentType;return new i(t,e)},e.prototype.bindData=function(){var t=[UUType.TEXT,UUType.IMAGE];-1!==t.indexOf(this.styleType)&&this.observer(this.props)},e.prototype.observer=function(t){var e=this;Object.keys(t).forEach(function(i){return e.defineActive(t,i,t[i])})},e.prototype.defineActive=function(t,e,i){var n=this;Object.defineProperty(t,e,{enumerable:!0,configurable:!0,get:function(){return n._props[e]},set:function(t){t!==n._props[e]&&n.isTargetSelected()&&(n._props[e]=t,console.log("props key is change"),n.refresh())}})},e.prototype.refresh=function(){var t=this.siderbar.tool,e=t.target.owner.image,i=t.target,n=i.owner;t.setTarget(null),this.siderbar.editGroup.clear(),this.siderbar.updateDisplay(n),i.width=e.width,i.height=e.height,t.setTarget(i),t.draw(),this.siderbar.component_style.updateTarget()},e.prototype.isTargetSelected=function(){var t=this.siderbar.editGroup.tool,e=t.target;return t&&e?!0:!1},e}(eui.Component);__reflect(StyleType.prototype,"StyleType",["IUUContainer"]);var TabAnimation=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.editGroup=t.editGroup},e.prototype.onAddedToStage=function(){this.init()},e.prototype.init=function(){},e}(eui.Component);__reflect(TabAnimation.prototype,"TabAnimation",["IUUContainer"]);var TabEvent=function(t){function e(){var e=t.call(this)||this;return e.stateObj={selectionVisible:!1},e.isFirstSelect=!0,e.relevanceItemIdList=[],e.defaultRelevanceItem={delay:100,eventType:1,sourceId:8405,sourceType:"e",targetId:8405,targetState:1,targetType:"e"},e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.editGroup=t.editGroup},Object.defineProperty(e.prototype,"triggerGroup",{get:function(){return this._triggerGroup},set:function(t){var e=this;this._triggerGroup=t;var i=t.filter(function(t){return t.sourceId==e.targetItemId});this.relevanceItemIdList=i.map(function(t){return t.targetId});for(var n={},o=0,r=i.length;r>o;o++){var a=i[o];n[a.targetId]=a}this.relevanceItemIdObj=n,this.initShowEventSetList()},enumerable:!0,configurable:!0}),e.prototype.onAddedToStage=function(){this.init()},e.prototype.init=function(){mouse.enable(this.stage),mouse.setMouseMoveEnabled(!0),this.initLayout(),this.listenEvent()},e.prototype.initLayout=function(){var t=new eui.VerticalLayout;t.paddingTop=5,this.gp_eventSetContainer.layout=t;var e=new eui.VerticalLayout;e.gap=0,e.paddingTop=5,this.gp_selection.layout=e},e.prototype.listenEvent=function(){var t=this;this.addEventListener(egret.TouchEvent.TOUCH_TAP,function(e){t.stateObj.selectionVisible=!1;var i=t.editGroup.maskTool;i.removeMask()},this),this.gp_selection_rect.addEventListener(egret.TouchEvent.TOUCH_TAP,this.touchSelection2,this)},e.prototype.getTargetItemId=function(){this.targetItemId=this.editGroup.tool.target.owner.image.data.id},e.prototype.touchSelection2=function(t){var e=this;if(t.stopPropagation(),this.targetItemId&&(this.stateObj.selectionVisible=!this.stateObj.selectionVisible,this.stateObj.selectionVisible)){this.gp_selection.removeChildren();for(var i=this.editGroup.displayList,n=function(t,n){var r=i[t].image.data,a=r.id,s=new CheckItem(a);s.addEventListener(egret.Event.ADDED_TO_STAGE,function(){var t=-1==e.relevanceItemIdList.indexOf(a)?!1:!0;s.isSelected=t},o),o.gp_selection.addChild(s)},o=this,r=0,a=i.length;a>r;r++)n(r,a);if(!this.isFirstSelect)return;this.isFirstSelect=!1,this.gp_selection.addEventListener(mouse.MouseEvent.MOUSE_OVER,this.onMouseover_Selection,this),this.gp_selection.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick_Selection,this)}},e.prototype.onMouseover_Selection=function(t){this.removeOver(),t.target.parent.isOver=!0;var e=t.target.parent.labelText;this.editGroup.triggerMaskById(e)},e.prototype.removeOver=function(){for(var t=0,e=this.gp_selection.numChildren;e>t;t++){var i=this.gp_selection.getChildAt(t);i.isOver=!1}},e.prototype.onClick_Selection=function(t){t.stopPropagation();var e=t.target,i=t.target.parent,n=e.selected;if(void 0!==n){var o=i.labelText,r=this.relevanceItemIdObj[o];r||(this.relevanceItemIdObj[o]=JSON.parse(JSON.stringify(this.defaultRelevanceItem)),this.relevanceItemIdObj[o].sourceId=this.targetItemId,this.relevanceItemIdObj[o].targetId=o,r=this.relevanceItemIdObj[o]),n?(this.pushEventSet(r),this.relevanceItemIdList.push(o)):this.removeEventSet(r)}},e.prototype.drawEventSet=function(t){var e=new EventSetDome;return e.initData(t),e.getDataContainer(this),e.draw(this.gp_eventSetContainer),e},e.prototype.pushEventSet=function(t){var e=this.drawEventSet(t);e.pushData()},e.prototype.removeEventSet=function(t){var e=t.targetId,i=this.gp_eventSetContainer.getChildByName(e);i.removeData()},e.prototype.initShowEventSetList=function(){this.gp_eventSetContainer.removeChildren();for(var t=this.editGroup.displayList,e=0,i=t.length;i>e;e++){var n=t[e].image.data.id,o=-1==this.relevanceItemIdList.indexOf(n)?!1:!0;if(o){var r=this.relevanceItemIdObj[n];this.drawEventSet(r)}}},e}(eui.Component);__reflect(TabEvent.prototype,"TabEvent",["IUUContainer"]);var TabLayer=function(t){function e(){var e=t.call(this)||this;return e.layers=[],e.elements=[],e.pageIndex=0,e.layerIndex=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.editGroup=this.container.editGroup},e.prototype.onAddedToStage=function(){this.getPages(),this.init(),this.removeChildren(),this.render()},e.prototype.init=function(){var t=new eui.VerticalLayout;t.paddingTop=0,t.gap=0,this.layout=t,this.stage.addEventListener(PageEvent.LAYER_ADD,this.layerAdd,this),this.stage.addEventListener(PageEvent.PAGE_CHANGE,this.pageChange,this),this.stage.addEventListener(PageEvent.LAYER_CHANGE,this.layerChange,this)},e.prototype["delete"]=function(t){this.editGroup.displayList[this.layerIndex].undraw(this.editGroup.displayGroup),this.editGroup.displayList.splice(this.layerIndex,1),this.elements.splice(this.layerIndex,1),this.removeChildren(),this.render(),this.editGroup.tool.setTarget(null),requestAnimationFrame(this.editGroup.render)},e.prototype.pageChange=function(t){this.getPages(),this.removeChildren(),this.render()},e.prototype.getPages=function(){this.elements=RES.getRes("data_json").list[this.editGroup.pageIndex].elements},e.prototype.render=function(t){void 0===t&&(t=0);var e=new eui.Group;e.width=500,e.height=80,this.addChild(e);var i=new eui.Button;i.width=100,i.height=40,i.label="删除",i.verticalCenter=0,i.horizontalCenter=0,i.addEventListener(Mouse.START,this["delete"],this),e.addChild(i),this.layers=[];var n=0,o=this.elements,r=o.length;for(n=0;r>n;n++){var a=new LayerItem(n);a.width=500,a.height=100,n==t?a.selected=!0:a.selected=!1,this.layers.push(a),a.draw(this)}},e.prototype.redraw=function(t){void 0===t&&(t=0),this.layerIndex=t;var e=0,i=this.layers.length;for(e=0;i>e;e++)e==t?this.layers[e].selected=!0:this.layers[e].selected=!1,this.layers[e].redraw(this)},e.prototype.layerAdd=function(t){var e=this.elements,i=new LayerItem(e.length-1);i.width=500,i.height=100,this.layers.push(i),i.draw(this),this.redraw(e.length-1),i.select(null)},e.prototype.layerChange=function(t){this.redraw(t.data.layerIndex)},e}(eui.Group);__reflect(TabLayer.prototype,"TabLayer",["IUUContainer"]);var Table=function(_super){function Table(t,e){var i=_super.call(this)||this;return i.isShow=!1,i.lineHeight=40,i.boxWidth=440,i.headData=t,i.data=e,i._data=JSON.parse(JSON.stringify(i.data)),i.observer(i.data),i.columnNum=i.headData.length,i.rowNum=i.data.length+1,i.addEventListener(egret.Event.ADDED_TO_STAGE,i.onAddToStage,i),i}return __extends(Table,_super),Table.prototype.onAddToStage=function(){this.init(),this.initEvent()},Table.prototype.init=function(){this.removeChildren(),this.gp_box=new eui.Group,this.gp_box.layout=this.createTileLayout(1),this.reload();var t=new eui.VerticalLayout;this.layout=t,this.addChild(this.gp_box),this.addChild(this.createBtnBox())},Table.prototype.reload=function(){this.gp_box.removeChildren(),this.gp_box.addChild(this.createHead());for(var t=0,e=this.data.length;e>t;t++){var i=this.data[t];this.gp_box.addChild(this.createRow(i,t))}},Table.prototype.initEvent=function(){this.btn_add.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_add_click,this)},Table.prototype.btn_add_click=function(){console.log("add...");var t=this.data[this.data.length-1];this.data.push(JSON.parse(JSON.stringify(t))),this._data=JSON.parse(JSON.stringify(this.data)),this.observer(this.data),this.reload(),this.deliverMessage()},Table.prototype.btn_del_click=function(t){console.log("del...");for(var e,i=t.target,n=i.parent,o=0,r=this.gp_box.numChildren;r>o;o++){var a=this.gp_box.getChildAt(o);a==n&&(e=o)}console.log("rowIndex = "+e);try{this.gp_box.removeChild(n),this.data.splice(e-1,1),this.deliverMessage()}catch(s){console.log(s)}},Table.prototype.createHead=function(){var t=new eui.Group;t.layout=this.createTileLayout(this.columnNum+1);for(var e=0,i=this.headData;e<i.length;e++){var n=i[e];t.addChild(this.createTh(n))}var o=this.createDelIcon();return o.visible=!1,t.addChild(o),t},Table.prototype.createRow=function(t,e){console.log("index = "+e);var i=new eui.Group;i.name=e.toString(),i.layout=this.createTileLayout(this.columnNum+1);for(var n in t){var o=this.createTd(n,t[n]);i.addChild(o)}var r=this.createDelIcon();return i.addChild(r),i},Table.prototype.createTh=function(t){var e=new eui.Group;e.width=this.boxWidth/this.columnNum,e.height=this.lineHeight;var i;return i=new eui.Label,i.textAlign="center",i.textColor=0,i.size=26,i.text=t,i.verticalAlign="middle",e.addChild(i),i.width=e.width,i.height=e.height,e},Table.prototype.createTd=function(key,value){var _this=this,group=new eui.Group,com=value.componentType?eval(value.componentType):eui.EditableText,item;switch(com){case eui.EditableText:item=new com,item.name=key,item.background=!0,item.backgroundColor=16777215,item.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusIn,this),item.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onFocusOut,this),item.textColor=0,item.size=26,item.text=value.value,item.verticalAlign="middle";break;case Select:var itemWidth=this.boxWidth/this.columnNum;item=new com(value.selectData,itemWidth),item.setDefaultItem(value.value);var callback=function(t){value.value=t};item.listenSelectChange(callback);break;case eui.Button:item=new com,item.label=value.value,item.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){var t=_this.container.siderbar.parent;t.openImagePanel(function(t){console.log(t),item.label=value.value=t},!0)},this)}return group.addChild(item),item.width=this.boxWidth/this.columnNum,item.height=this.lineHeight,group},Table.prototype.draw=function(t){this.container=t,this.container.addChild(this),this.isShow=!0},Table.prototype.undraw=function(){this.container.removeChild(this),this.isShow=!1},Table.prototype.listenChange=function(t){this.cb=t},Table.prototype.createTileLayout=function(t){var e=new eui.TileLayout;return e.horizontalGap=10,e.verticalGap=10,e.columnAlign=eui.ColumnAlign.JUSTIFY_USING_WIDTH,e.rowAlign=eui.RowAlign.JUSTIFY_USING_HEIGHT,e.requestedColumnCount=t,e},Table.prototype.createBtnBox=function(){var t=new eui.Group;t.width=this.boxWidth;var e=new eui.HorizontalLayout;return e.verticalAlign="middle",e.horizontalAlign="center",t.layout=e,this.btn_add=this.createBtn("添加"),t.addChild(this.btn_add),t},Table.prototype.createBtn=function(t){var e=new eui.Button;return e.height=40,e.width=80,e.label=t,e},Table.prototype.createDelIcon=function(){var t=30,e=30,i=new eui.Group;i.width=t,i.height=e;var n=new egret.Shape;n.graphics.lineStyle(1,0),n.graphics.beginFill(0,0),n.graphics.drawCircle(t/2,e/2,t/2),n.graphics.endFill();var o=new egret.Shape;return o.graphics.lineStyle(1,0),o.graphics.moveTo(t/4,e/2),o.graphics.lineTo(t/4*3,e/2),o.graphics.endFill(),i.addChild(n),i.addChild(o),i.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btn_del_click,this),i},Table.prototype.onFocusIn=function(t){console.log("onFocusIn...");var e=t.target,i=e.parent.parent;this.activeRow=i,this.activeIndex=Number(i.name),console.log(e),console.log(i)},Table.prototype.onFocusOut=function(t){console.log("onFocusOut...");var e=t.target,i=e.name,n=e.text;console.log(e),console.log(name),this.data[this.activeIndex][i].value=n},Table.prototype.observer=function(t){var e=this;t.forEach(function(t,i){return Object.keys(t).forEach(function(n){var o=t[n];Object.keys(o).forEach(function(t){"value"==t&&Object.defineProperty(o,t,{enumerable:!0,configurable:!0,get:function(){return e._data[i][n].value},set:function(t){t!==e._data[i][n].value&&(e._data[i][n].value=t,console.log("props key is change"),e.deliverMessage())}})})})})},Table.prototype.deliverMessage=function(){this.cb&&this.cb()},Table}(eui.Group);__reflect(Table.prototype,"Table");var TabPage=function(t){function e(){var e=t.call(this)||this;return e.pages=[],e.currentIndex=0,e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.container.addChild(this)},e.prototype.onAddedToStage=function(){this.getPages(),this.init(),this.removeChildren(),this.render(this.currentIndex)},e.prototype.init=function(){var t=new eui.VerticalLayout;t.paddingTop=0,t.gap=0,this.layout=t,this.stage.addEventListener(PageEvent.PAGE_ADD,this.pageAdd,this)},e.prototype.getPages=function(){this.pages=RES.getRes("data_json").list},e.prototype.render=function(t){var e=0,i=this.pages,n=i.length;for(e=0;n>e;e++){var o=new PageItem(e);o.width=500,o.height=100,e==t?o.selected=!0:o.selected=!1,o.draw(this)}},e.prototype.redraw=function(t){if(this.removeChildren(),"undefined"==typeof t){t=this.pages.length-1;var e=new PageEvent(PageEvent.PAGE_CHANGE,!0);e.data={pageIndex:t},this.dispatchEvent(e)}this.currentIndex=t,this.render(this.currentIndex)
},e.prototype.pageAdd=function(t){this.redraw()},e}(eui.Group);__reflect(TabPage.prototype,"TabPage",["IUUContainer"]);var TabStyle=function(t){function e(){var e=t.call(this)||this;return e.data={width:30,height:30,x:30,y:30,rotate:10},e.soundPanel=StyleSound.getInstance(),e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){this.container=t,this.editGroup=t.editGroup},e.prototype.onAddedToStage=function(){this.kb=new KeyBoard,this.initEvent()},e.prototype.initEvent=function(){for(var t=0,e=this.gp_inputContainer.numChildren;e>t;t++){var i=this.gp_inputContainer.getChildAt(t),n=i.getChildAt(1);n.addEventListener(egret.FocusEvent.FOCUS_OUT,this.onFocusOut,this),n.addEventListener(egret.FocusEvent.FOCUS_IN,this.onFocusIn,this)}},e.prototype.createStyleType=function(t){this.gp_diff.removeChildren();var e=t.type,i=t.props,n=new StyleType(e,i);n.draw(this.gp_diff)},e.prototype.setTarget=function(){this.tool=this.editGroup.tool,console.log(this.tool);var t=this.tool.target.owner.image.data;this.createStyleType(t),this.soundPanel.draw(this.gp_container),this.soundPanel.setData(t.sound)},e.prototype.updateTarget=function(){var t=this.tool.target.owner.image,e=t.width,i=t.height,n=t.scaleX,o=t.scaleY,r=t.rotation,a={x:Math.floor(this.tool.regX),y:Math.floor(this.tool.regY),width:Math.floor(e*n),height:Math.floor(i*o),rotate:Math.floor(r)||"0"};this.preData=JSON.parse(JSON.stringify(a)),this.data=a},e.prototype.onFocusIn=function(t){console.log("onFocusIn..."),console.log("add keyboard...");var e=t.target.parent,i=e.name,n=i.split("_")[1];this.inputType=n,console.log(n),this.kb.addEventListener(KeyBoard.onkeydown,this.onkeydown,this)},e.prototype.onFocusOut=function(t){if(console.log("onFocusOut..."),console.log("remove keyboard..."),this.preData){this.kb.removeEventListener(KeyBoard.onkeydown,this.onkeydown,this);var e=Number(t.target.text)-this.preData[this.inputType];e&&this.adjuctMatrix(e)}},e.prototype.onkeydown=function(t){console.log("onkeydown..."),t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation(),this.kb.isContain(t.data,KeyBoard.DownArrow)&&(console.log(t.data),this.adjuctMatrix(-1)),this.kb.isContain(t.data,KeyBoard.UpArrow)&&(console.log(t.data),this.adjuctMatrix(1))},e.prototype.adjuctMatrix=function(t){var e=t,i=this.tool;if(i&&i.target){switch(console.log(e),this.inputType){case"width":console.log("width"),this.data.width+=e,i.scale(this.data.width/this.preData.width),this.preData.width=this.data.width;break;case"height":console.log("height"),this.data.height+=e,i.scale(this.data.height/this.preData.height),this.preData.height=this.data.height;break;case"x":console.log("x"),this.data.x+=e,i.translate(e,0),this.preData.x=this.data.x;break;case"y":console.log("y"),this.data.y+=e,i.translate(0,e),this.preData.y=this.data.y;break;case"rotate":console.log("rotate"),this.data.rotate=Number(this.data.rotate)+e,i.rotate(e*Math.PI/180),this.preData.rotate=this.data.rotate}this.tool.startMatrix.copyFrom(this.tool.endMatrix),this.container.renderOneDisplay()}},e}(eui.Component);__reflect(TabStyle.prototype,"TabStyle",["IUUContainer"]);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function o(t){e.call(n,t)}function r(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),i.call(n))}var a=this;"undefined"!=typeof generateEUI?egret.callLater(function(){e.call(n,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,r,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT))},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var TriggerPanel=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddToStage,e),e}return __extends(e,t),e.prototype.onAddToStage=function(t){},e}(eui.Group);__reflect(TriggerPanel.prototype,"TriggerPanel");var UUBorderContainer=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.onAddedToStage,e),e}return __extends(e,t),e.prototype.dispose=function(){},e.prototype.draw=function(t){},e.prototype.onAddedToStage=function(){},e}(eui.Group);__reflect(UUBorderContainer.prototype,"UUBorderContainer",["IUUContainer"]);var UUComType;!function(t){t.StyleInput="StyleInput",t.StyleSelect="StyleSelect",t.StyleTextColor="StyleTextColor"}(UUComType||(UUComType={}));var UUPanelConfig=(_a={},_a[UUType.TEXT]=[{type:"text",title:"文本",componentType:StyleTextInput},{type:"fontFamily",title:"字体",componentType:StyleTextSelect,selectData:[{content:"Arial"},{content:"DFKai-SB"},{content:"FangSong"},{content:"Georgia"},{content:"Helvetica"},{content:"KaiTi"},{content:"Lucida Family"}]},{type:"size",title:"字号",componentType:StyleTextInput},{type:"textColor",title:"颜色",componentType:StyleTextColor}],_a[UUType.CIRCLE_SECTOR]=[{type:"awards",title:"转盘",componentType:StyleCircleSector}],_a[UUType.SLIDESHOW]=[{type:"awards",title:"轮播图",componentType:StyleSlideshow}],_a[UUType.SLOT_MACHINE]=[{type:"bgColor",title:"背景色",componentType:StyleColor},{type:"bdUrl",title:"边框",componentType:StyleImage},{type:"awards",title:"老虎机",componentType:StyleSlideshow}],_a),_a;